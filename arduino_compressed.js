// Do not edit this file; automatically generated by build.py.
'use strict';


Blockly.Arduino=new Blockly.Generator("Arduino");Blockly.Arduino.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(Blockly.utils.global).join(","));Blockly.Arduino.ORDER_ATOMIC=0;
Blockly.Arduino.ORDER_NEW=1.1;Blockly.Arduino.ORDER_MEMBER=1.2;Blockly.Arduino.ORDER_FUNCTION_CALL=2;Blockly.Arduino.ORDER_INCREMENT=3;Blockly.Arduino.ORDER_DECREMENT=3;Blockly.Arduino.ORDER_BITWISE_NOT=4.1;Blockly.Arduino.ORDER_UNARY_PLUS=4.2;Blockly.Arduino.ORDER_UNARY_NEGATION=4.3;Blockly.Arduino.ORDER_LOGICAL_NOT=4.4;Blockly.Arduino.ORDER_TYPEOF=4.5;Blockly.Arduino.ORDER_VOID=4.6;Blockly.Arduino.ORDER_DELETE=4.7;Blockly.Arduino.ORDER_AWAIT=4.8;Blockly.Arduino.ORDER_EXPONENTIATION=5;
Blockly.Arduino.ORDER_MULTIPLICATION=5.1;Blockly.Arduino.ORDER_DIVISION=5.2;Blockly.Arduino.ORDER_MODULUS=5.3;Blockly.Arduino.ORDER_SUBTRACTION=6.1;Blockly.Arduino.ORDER_ADDITION=6.2;Blockly.Arduino.ORDER_BITWISE_SHIFT=7;Blockly.Arduino.ORDER_RELATIONAL=8;Blockly.Arduino.ORDER_IN=8;Blockly.Arduino.ORDER_INSTANCEOF=8;Blockly.Arduino.ORDER_EQUALITY=9;Blockly.Arduino.ORDER_BITWISE_AND=10;Blockly.Arduino.ORDER_BITWISE_XOR=11;Blockly.Arduino.ORDER_BITWISE_OR=12;Blockly.Arduino.ORDER_LOGICAL_AND=13;
Blockly.Arduino.ORDER_LOGICAL_OR=14;Blockly.Arduino.ORDER_CONDITIONAL=15;Blockly.Arduino.ORDER_ASSIGNMENT=16;Blockly.Arduino.ORDER_YIELD=17;Blockly.Arduino.ORDER_COMMA=18;Blockly.Arduino.ORDER_NONE=99;
var profile={Arduino:{description:"Arduino standard-compatible board",digital:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]],analog:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]],serial:9600},Arduino_mega:{description:"Arduino Mega-compatible board"}};profile["default"]=profile.Arduino;
Blockly.Arduino.ORDER_OVERRIDES=[[Blockly.Arduino.ORDER_FUNCTION_CALL,Blockly.Arduino.ORDER_MEMBER],[Blockly.Arduino.ORDER_FUNCTION_CALL,Blockly.Arduino.ORDER_FUNCTION_CALL],[Blockly.Arduino.ORDER_MEMBER,Blockly.Arduino.ORDER_MEMBER],[Blockly.Arduino.ORDER_MEMBER,Blockly.Arduino.ORDER_FUNCTION_CALL],[Blockly.Arduino.ORDER_LOGICAL_NOT,Blockly.Arduino.ORDER_LOGICAL_NOT],[Blockly.Arduino.ORDER_MULTIPLICATION,Blockly.Arduino.ORDER_MULTIPLICATION],[Blockly.Arduino.ORDER_ADDITION,Blockly.Arduino.ORDER_ADDITION],
[Blockly.Arduino.ORDER_LOGICAL_AND,Blockly.Arduino.ORDER_LOGICAL_AND],[Blockly.Arduino.ORDER_LOGICAL_OR,Blockly.Arduino.ORDER_LOGICAL_OR]];
Blockly.Arduino.init=function(a){Blockly.Arduino.includes_=Object.create(null);Blockly.Arduino.definitions_=Object.create(null);Blockly.Arduino.variables_=Object.create(null);Blockly.Arduino.codeFunctions_=Object.create(null);Blockly.Arduino.userFunctions_=Object.create(null);Blockly.Arduino.functionNames_=Object.create(null);Blockly.Arduino.setups_=Object.create(null);Blockly.Arduino.pins_=Object.create(null);Blockly.Arduino.variableDB_?Blockly.Arduino.variableDB_.reset():Blockly.Arduino.variableDB_=
new Blockly.Names(Blockly.Arduino.RESERVED_WORDS_);Blockly.Arduino.variableDB_.setVariableMap(a.getVariableMap());for(var b=[],c=Blockly.Variables.allDeveloperVariables(a),d=0;d<c.length;d++)b.push(Blockly.Arduino.variableDB_.getName(c[d],Blockly.Names.DEVELOPER_VARIABLE_TYPE));a=Blockly.Variables.allUsedVarModels(a);for(d=0;d<a.length;d++)b.push(Blockly.Arduino.variableDB_.getName(a[d].getId(),Blockly.VARIABLE_CATEGORY_NAME));Blockly.Arduino.definitions_.variables="";for(d=0;d<b.length;d++)switch(a[d].type){case "Boolean":Blockly.Arduino.definitions_.variables+=
"boolean "+b[d]+";\n";break;case "Number":Blockly.Arduino.definitions_.variables+="int16_t "+b[d]+";\n"}};
Blockly.Arduino.finish=function(a){var b=[],c=[];for(h in Blockly.Arduino.definitions_){var d=Blockly.Arduino.definitions_[h];d.match(/^#include/)?b.push(d):c.push(d)}d=[];c=[];var e=[],f=[];for(h in Blockly.Arduino.includes_)d.push(Blockly.Arduino.includes_[h]);d.length&&d.push("\n");for(h in Blockly.Arduino.definitions_)c.push(Blockly.Arduino.definitions_[h]);c.length&&c.push("\n");for(h in Blockly.Arduino.variables_)e.push(Blockly.Arduino.variables_[h]);e.length&&e.push("\n");for(h in Blockly.Arduino.codeFunctions_)f.push(Blockly.Arduino.codeFunctions_[h]);
for(h in Blockly.Arduino.userFunctions_)f.push(Blockly.Arduino.userFunctions_[h]);f.length&&f.push("\n");b=[""];var g="";void 0!==Blockly.Arduino.setups_.userSetupCode&&(g="\n"+Blockly.Arduino.setups_.userSetupCode,delete Blockly.Arduino.setups_.userSetupCode);for(h in Blockly.Arduino.setups_)b.push(Blockly.Arduino.setups_[h]);g&&b.push(g);delete Blockly.Arduino.includes_;delete Blockly.Arduino.definitions_;delete Blockly.Arduino.codeFunctions_;delete Blockly.Arduino.userFunctions_;delete Blockly.Arduino.functionNames_;
delete Blockly.Arduino.setups_;delete Blockly.Arduino.pins_;Blockly.Arduino.variableDB_.reset();c=d.join("\n")+c.join("\n")+e.join("\n")+f.join("\n\n");var h="void setup() {"+b.join("\n  ")+"\n}\n\n";a="void loop() {\n  "+a.replace(/\n/g,"\n  ")+"\n}";return c+h+a};Blockly.Arduino.addInclude=function(a,b){void 0===Blockly.Arduino.includes_[a]&&(Blockly.Arduino.includes_[a]=b)};Blockly.Arduino.addDeclaration=function(a,b){void 0===Blockly.Arduino.definitions_[a]&&(Blockly.Arduino.definitions_[a]=b)};
Blockly.Arduino.addVariable=function(a,b,c){var d=!1;if(c||void 0===Blockly.Arduino.variables_[a])Blockly.Arduino.variables_[a]=b,d=!0;return d};Blockly.Arduino.addSetup=function(a,b,c){var d=!1;if(c||void 0===Blockly.Arduino.setups_[a])Blockly.Arduino.setups_[a]=b,d=!0;return d};
Blockly.Arduino.addFunction=function(a,b){if(void 0===Blockly.Arduino.codeFunctions_[a]){var c=Blockly.Arduino.variableDB_.getDistinctName(a,Blockly.Generator.NAME_TYPE);Blockly.Arduino.codeFunctions_[a]=b.replace(Blockly.Arduino.DEF_FUNC_NAME,c);Blockly.Arduino.functionNames_[a]=c}return Blockly.Arduino.functionNames_[a]};
Blockly.Arduino.reservePin=function(a,b,c,d){void 0!==Blockly.Arduino.pins_[b]?Blockly.Arduino.pins_[b]!=c?a.setWarningText(Blockly.Msg.ARD_PIN_WARN1.replace("%1",b).replace("%2",d).replace("%3",c).replace("%4",Blockly.Arduino.pins_[b]),d):a.setWarningText(null,d):(Blockly.Arduino.pins_[b]=c,a.setWarningText(null,d))};Blockly.Arduino.scrubNakedValue=function(a){return a+";\n"};Blockly.Arduino.quote_=function(a){a=a.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'");return'"'+a+'"'};
Blockly.Arduino.multiline_quote_=function(a){return a.split(/\n/g).map(Blockly.Arduino.quote_).join(' + "\\n" +\n')};
Blockly.Arduino.scrub_=function(a,b,c){var d="";if(!a.outputConnection||!a.outputConnection.targetConnection){var e=a.getCommentText();e&&(e=Blockly.utils.string.wrap(e,Blockly.Arduino.COMMENT_WRAP-3),d+=Blockly.Arduino.prefixLines(e+"\n","// "));for(var f=0;f<a.inputList.length;f++)a.inputList[f].type==Blockly.INPUT_VALUE&&(e=a.inputList[f].connection.targetBlock())&&(e=Blockly.Arduino.allNestedComments(e))&&(d+=Blockly.Arduino.prefixLines(e,"// "))}a=a.nextConnection&&a.nextConnection.targetBlock();
c=c?"":Blockly.Arduino.blockToCode(a);return d+b+c};
Blockly.Arduino.getAdjusted=function(a,b,c,d,e){c=c||0;e=e||Blockly.Arduino.ORDER_NONE;a.workspace.options.oneBasedIndex&&c--;var f=a.workspace.options.oneBasedIndex?"1":"0";a=0<c?Blockly.Arduino.valueToCode(a,b,Blockly.Arduino.ORDER_ADDITION)||f:0>c?Blockly.Arduino.valueToCode(a,b,Blockly.Arduino.ORDER_SUBTRACTION)||f:d?Blockly.Arduino.valueToCode(a,b,Blockly.Arduino.ORDER_UNARY_NEGATION)||f:Blockly.Arduino.valueToCode(a,b,e)||f;if(Blockly.isNumber(a))a=Number(a)+c,d&&(a=-a);else{if(0<c){a=a+" + "+
c;var g=Blockly.Arduino.ORDER_ADDITION}else 0>c&&(a=a+" - "+-c,g=Blockly.Arduino.ORDER_SUBTRACTION);d&&(a=c?"-("+a+")":"-"+a,g=Blockly.Arduino.ORDER_UNARY_NEGATION);g=Math.floor(g);e=Math.floor(e);g&&e>=g&&(a="("+a+")")}return a};Blockly.Arduino.arduino={};Blockly.Arduino.arduino_setup=function(a){a=Blockly.Arduino.statementToCode(this,"DO");Blockly.Arduino.INFINITE_LOOP_TRAP&&(a=Blockly.Arduino.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+this.id+"'")+a);var b=Blockly.Arduino.variableDB_.getDistinctName("arduino_setup",Blockly.Variables.NAME_TYPE);Blockly.Arduino.setups_[b]=a;return""};Blockly.Arduino.arduino_loop=function(a){var b=Blockly.Arduino.statementToCode(a,"DOLOOP");return b=Blockly.Arduino.addLoopTrap(b,a)};
Blockly.Arduino.arduino_comment=function(a){return"// "+this.getFieldValue("TEXT")+"\n"};Blockly.Arduino.arduino_highlow=function(a){return["HIGH"==this.getFieldValue("BOOL")?"HIGH":"LOW",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.arduino_digital_write=function(a){a=this.getFieldValue("PIN");var b=this.getFieldValue("STAT");Blockly.Arduino.setups_["setup_output_"+a]="pinMode("+a+", OUTPUT);";return"digitalWrite("+a+", "+b+");\n"};
Blockly.Arduino.arduino_digital_read=function(a){a=this.getFieldValue("PIN");Blockly.Arduino.setups_["setup_input_"+a]="pinMode("+a+", INPUT);";return["digitalRead("+a+")",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.arduino_analog_write=function(a){a=this.getFieldValue("PIN");var b=Blockly.Arduino.valueToCode(this,"NUM",Blockly.Arduino.ORDER_ATOMIC);return"analogWrite("+a+", "+b+");\n"};Blockly.Arduino.arduino_analog_read=function(a){return["analogRead("+this.getFieldValue("PIN")+")",Blockly.Arduino.ORDER_ATOMIC]};
Blockly.Arduino.arduino_tone=function(a){a=this.getFieldValue("PIN");var b=Blockly.Arduino.valueToCode(this,"NUM",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(this,"NUM2",Blockly.Arduino.ORDER_ATOMIC);Blockly.Arduino.setups_["setup_output"+a]="pinMode("+a+", OUTPUT);";return"tone("+a+", "+b+", "+c+");\n"};Blockly.Arduino.arduino_notone=function(a){a=this.getFieldValue("PIN");Blockly.Arduino.setups_["setup_output"+a]="pinMode("+a+", OUTPUT);";return"noTone("+a+");\n"};
Blockly.Arduino.arduino_delay=function(a){return"delay("+Blockly.Arduino.valueToCode(this,"DELAY_TIME",Blockly.Arduino.ORDER_ATOMIC)+");\n"};Blockly.Arduino.arduino_end=function(a){return"while(true);\n"};Blockly.Arduino.arduino_random=function(a){a=Blockly.Arduino.valueToCode(this,"rand_min",Blockly.Arduino.ORDER_ATOMIC);var b=Blockly.Arduino.valueToCode(this,"rand_max",Blockly.Arduino.ORDER_ATOMIC);return["random("+a+","+b+")",Blockly.Arduino.ORDER_NONE]};Blockly.Arduino.arduino_random_seed=function(a){return"randomSeed(analogRead(0));\n"};
Blockly.Arduino.arduino_serial_print=function(a){a=Blockly.Arduino.valueToCode(this,"CONTENT",Blockly.Arduino.ORDER_ATOMIC)||"0";Blockly.Arduino.setups_["setup_serial_"+profile["default"].serial]="Serial.begin("+profile["default"].serial+");\n";return"Serial.println("+a+");\n"};
Blockly.Arduino.arduino_servo_move=function(){var a=this.getFieldValue("PIN"),b=Blockly.Arduino.valueToCode(this,"DEGREE",Blockly.Arduino.ORDER_ATOMIC);Blockly.Arduino.definitions_.define_servo="#include <Servo.h>\n";Blockly.Arduino.definitions_["var_servo"+a]="Servo servo_"+a+";\n";Blockly.Arduino.setups_["setup_servo_"+a]="servo_"+a+".attach("+a+");\n";return"servo_"+a+".write("+b+");\n"};Blockly.Arduino.colour={};Blockly.Arduino.colour_picker=function(a){return[Blockly.Arduino.quote_(a.getFieldValue("COLOUR")),Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.colour_random=function(a){return[Blockly.Arduino.provideFunction_("colourRandom",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.colour_rgb=function(a){var b=Blockly.Arduino.valueToCode(a,"RED",Blockly.Arduino.ORDER_COMMA)||0,c=Blockly.Arduino.valueToCode(a,"GREEN",Blockly.Arduino.ORDER_COMMA)||0;a=Blockly.Arduino.valueToCode(a,"BLUE",Blockly.Arduino.ORDER_COMMA)||0;return[Blockly.Arduino.provideFunction_("colourRgb",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;",
"  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+b+", "+c+", "+a+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.colour_blend=function(a){var b=Blockly.Arduino.valueToCode(a,"COLOUR1",Blockly.Arduino.ORDER_COMMA)||"'#000000'",c=Blockly.Arduino.valueToCode(a,"COLOUR2",Blockly.Arduino.ORDER_COMMA)||"'#000000'";a=Blockly.Arduino.valueToCode(a,"RATIO",Blockly.Arduino.ORDER_COMMA)||.5;return[Blockly.Arduino.provideFunction_("colourBlend",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);",
"  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);",
"  return '#' + r + g + b;","}"])+"("+b+", "+c+", "+a+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};Blockly.Arduino.lists={};Blockly.Arduino.lists_create_empty=function(a){return["[]",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.lists_create_with=function(a){for(var b=Array(a.itemCount_),c=0;c<a.itemCount_;c++)b[c]=Blockly.Arduino.valueToCode(a,"ADD"+c,Blockly.Arduino.ORDER_COMMA)||"null";return["["+b.join(", ")+"]",Blockly.Arduino.ORDER_ATOMIC]};
Blockly.Arduino.lists_repeat=function(a){var b=Blockly.Arduino.provideFunction_("listsRepeat",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"]),c=Blockly.Arduino.valueToCode(a,"ITEM",Blockly.Arduino.ORDER_COMMA)||"null";a=Blockly.Arduino.valueToCode(a,"NUM",Blockly.Arduino.ORDER_COMMA)||"0";return[b+"("+c+", "+a+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.lists_length=function(a){return[(Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_MEMBER)||"[]")+".length",Blockly.Arduino.ORDER_MEMBER]};Blockly.Arduino.lists_isEmpty=function(a){return["!"+(Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_MEMBER)||"[]")+".length",Blockly.Arduino.ORDER_LOGICAL_NOT]};
Blockly.Arduino.lists_indexOf=function(a){var b="FIRST"==a.getFieldValue("END")?"indexOf":"lastIndexOf",c=Blockly.Arduino.valueToCode(a,"FIND",Blockly.Arduino.ORDER_NONE)||"''";b=(Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_MEMBER)||"[]")+"."+b+"("+c+")";return a.workspace.options.oneBasedIndex?[b+" + 1",Blockly.Arduino.ORDER_ADDITION]:[b,Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.lists_getIndex=function(a){var b=a.getFieldValue("MODE")||"GET",c=a.getFieldValue("WHERE")||"FROM_START",d=Blockly.Arduino.valueToCode(a,"VALUE","RANDOM"==c?Blockly.Arduino.ORDER_COMMA:Blockly.Arduino.ORDER_MEMBER)||"[]";switch(c){case "FIRST":if("GET"==b)return[d+"[0]",Blockly.Arduino.ORDER_MEMBER];if("GET_REMOVE"==b)return[d+".shift()",Blockly.Arduino.ORDER_MEMBER];if("REMOVE"==b)return d+".shift();\n";break;case "LAST":if("GET"==b)return[d+".slice(-1)[0]",Blockly.Arduino.ORDER_MEMBER];
if("GET_REMOVE"==b)return[d+".pop()",Blockly.Arduino.ORDER_MEMBER];if("REMOVE"==b)return d+".pop();\n";break;case "FROM_START":a=Blockly.Arduino.getAdjusted(a,"AT");if("GET"==b)return[d+"["+a+"]",Blockly.Arduino.ORDER_MEMBER];if("GET_REMOVE"==b)return[d+".splice("+a+", 1)[0]",Blockly.Arduino.ORDER_FUNCTION_CALL];if("REMOVE"==b)return d+".splice("+a+", 1);\n";break;case "FROM_END":a=Blockly.Arduino.getAdjusted(a,"AT",1,!0);if("GET"==b)return[d+".slice("+a+")[0]",Blockly.Arduino.ORDER_FUNCTION_CALL];
if("GET_REMOVE"==b)return[d+".splice("+a+", 1)[0]",Blockly.Arduino.ORDER_FUNCTION_CALL];if("REMOVE"==b)return d+".splice("+a+", 1);";break;case "RANDOM":d=Blockly.Arduino.provideFunction_("listsGetRandomItem",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+d+", "+("GET"!=b)+")";if("GET"==b||"GET_REMOVE"==b)return[d,
Blockly.Arduino.ORDER_FUNCTION_CALL];if("REMOVE"==b)return d+";\n"}throw Error("Unhandled combination (lists_getIndex).");};
Blockly.Arduino.lists_setIndex=function(a){function b(){if(c.match(/^\w+$/))return"";var g=Blockly.Arduino.variableDB_.getDistinctName("tmpList",Blockly.VARIABLE_CATEGORY_NAME),h="var "+g+" = "+c+";\n";c=g;return h}var c=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_MEMBER)||"[]",d=a.getFieldValue("MODE")||"GET",e=a.getFieldValue("WHERE")||"FROM_START",f=Blockly.Arduino.valueToCode(a,"TO",Blockly.Arduino.ORDER_ASSIGNMENT)||"null";switch(e){case "FIRST":if("SET"==d)return c+"[0] = "+f+
";\n";if("INSERT"==d)return c+".unshift("+f+");\n";break;case "LAST":if("SET"==d)return a=b(),a+(c+"["+c+".length - 1] = "+f+";\n");if("INSERT"==d)return c+".push("+f+");\n";break;case "FROM_START":e=Blockly.Arduino.getAdjusted(a,"AT");if("SET"==d)return c+"["+e+"] = "+f+";\n";if("INSERT"==d)return c+".splice("+e+", 0, "+f+");\n";break;case "FROM_END":e=Blockly.Arduino.getAdjusted(a,"AT",1,!1,Blockly.Arduino.ORDER_SUBTRACTION);a=b();if("SET"==d)return a+(c+"["+c+".length - "+e+"] = "+f+";\n");if("INSERT"==
d)return a+(c+".splice("+c+".length - "+e+", 0, "+f+");\n");break;case "RANDOM":a=b();e=Blockly.Arduino.variableDB_.getDistinctName("tmpX",Blockly.VARIABLE_CATEGORY_NAME);a+="var "+e+" = Math.floor(Math.random() * "+c+".length);\n";if("SET"==d)return a+(c+"["+e+"] = "+f+";\n");if("INSERT"==d)return a+(c+".splice("+e+", 0, "+f+");\n")}throw Error("Unhandled combination (lists_setIndex).");};
Blockly.Arduino.lists.getIndex_=function(a,b,c){return"FIRST"==b?"0":"FROM_END"==b?a+".length - 1 - "+c:"LAST"==b?a+".length - 1":c};
Blockly.Arduino.lists_getSublist=function(a){var b=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_MEMBER)||"[]",c=a.getFieldValue("WHERE1"),d=a.getFieldValue("WHERE2");if("FIRST"==c&&"LAST"==d)b+=".slice(0)";else if(b.match(/^\w+$/)||"FROM_END"!=c&&"FROM_START"==d){switch(c){case "FROM_START":var e=Blockly.Arduino.getAdjusted(a,"AT1");break;case "FROM_END":e=Blockly.Arduino.getAdjusted(a,"AT1",1,!1,Blockly.Arduino.ORDER_SUBTRACTION);e=b+".length - "+e;break;case "FIRST":e="0";break;default:throw Error("Unhandled option (lists_getSublist).");
}switch(d){case "FROM_START":a=Blockly.Arduino.getAdjusted(a,"AT2",1);break;case "FROM_END":a=Blockly.Arduino.getAdjusted(a,"AT2",0,!1,Blockly.Arduino.ORDER_SUBTRACTION);a=b+".length - "+a;break;case "LAST":a=b+".length";break;default:throw Error("Unhandled option (lists_getSublist).");}b=b+".slice("+e+", "+a+")"}else{e=Blockly.Arduino.getAdjusted(a,"AT1");a=Blockly.Arduino.getAdjusted(a,"AT2");var f=Blockly.Arduino.lists.getIndex_,g={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};
b=Blockly.Arduino.provideFunction_("subsequence"+g[c]+g[d],["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==d||"FROM_START"==d?", at2":"")+") {","  var start = "+f("sequence",c,"at1")+";","  var end = "+f("sequence",d,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+b+("FROM_END"==c||"FROM_START"==c?", "+e:"")+("FROM_END"==d||"FROM_START"==d?", "+a:"")+")"}return[b,Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.lists_sort=function(a){var b=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_FUNCTION_CALL)||"[]",c="1"===a.getFieldValue("DIRECTION")?1:-1;a=a.getFieldValue("TYPE");var d=Blockly.Arduino.provideFunction_("listsGetSortCompare",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",
'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"]);return[b+".slice().sort("+d+'("'+a+'", '+c+"))",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.lists_split=function(a){var b=Blockly.Arduino.valueToCode(a,"INPUT",Blockly.Arduino.ORDER_MEMBER),c=Blockly.Arduino.valueToCode(a,"DELIM",Blockly.Arduino.ORDER_NONE)||"''";a=a.getFieldValue("MODE");if("SPLIT"==a)b||(b="''"),a="split";else if("JOIN"==a)b||(b="[]"),a="join";else throw Error("Unknown mode: "+a);return[b+"."+a+"("+c+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.lists_reverse=function(a){return[(Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",Blockly.Arduino.ORDER_FUNCTION_CALL]};Blockly.Arduino.logic={};
Blockly.Arduino.controls_if=function(a){var b=0,c="";Blockly.Arduino.STATEMENT_PREFIX&&(c+=Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_PREFIX,a));do{var d=Blockly.Arduino.valueToCode(a,"IF"+b,Blockly.Arduino.ORDER_NONE)||"false";var e=Blockly.Arduino.statementToCode(a,"DO"+b);Blockly.Arduino.STATEMENT_SUFFIX&&(e=Blockly.Arduino.prefixLines(Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_SUFFIX,a),Blockly.Arduino.INDENT)+e);c+=(0<b?" else ":"")+"if ("+d+") {\n"+e+"}";++b}while(a.getInput("IF"+
b));if(a.getInput("ELSE")||Blockly.Arduino.STATEMENT_SUFFIX)e=Blockly.Arduino.statementToCode(a,"ELSE"),Blockly.Arduino.STATEMENT_SUFFIX&&(e=Blockly.Arduino.prefixLines(Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_SUFFIX,a),Blockly.Arduino.INDENT)+e),c+=" else {\n"+e+"}";return c+"\n"};Blockly.Arduino.controls_ifelse=Blockly.Arduino.controls_if;
Blockly.Arduino.logic_compare=function(a){var b={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[a.getFieldValue("OP")],c="=="==b||"!="==b?Blockly.Arduino.ORDER_EQUALITY:Blockly.Arduino.ORDER_RELATIONAL,d=Blockly.Arduino.valueToCode(a,"A",c)||"0";a=Blockly.Arduino.valueToCode(a,"B",c)||"0";return[d+" "+b+" "+a,c]};
Blockly.Arduino.logic_operation=function(a){var b="AND"==a.getFieldValue("OP")?"&&":"||",c="&&"==b?Blockly.Arduino.ORDER_LOGICAL_AND:Blockly.Arduino.ORDER_LOGICAL_OR,d=Blockly.Arduino.valueToCode(a,"A",c);a=Blockly.Arduino.valueToCode(a,"B",c);if(d||a){var e="&&"==b?"true":"false";d||(d=e);a||(a=e)}else a=d="false";return[d+" "+b+" "+a,c]};Blockly.Arduino.logic_negate=function(a){var b=Blockly.Arduino.ORDER_LOGICAL_NOT;return["!"+(Blockly.Arduino.valueToCode(a,"BOOL",b)||"true"),b]};
Blockly.Arduino.logic_boolean=function(a){return["TRUE"==a.getFieldValue("BOOL")?"true":"false",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.logic_null=function(a){return["NULL",Blockly.Arduino.ORDER_ATOMIC]};
Blockly.Arduino.logic_ternary=function(a){var b=Blockly.Arduino.valueToCode(a,"IF",Blockly.Arduino.ORDER_CONDITIONAL)||"false",c=Blockly.Arduino.valueToCode(a,"THEN",Blockly.Arduino.ORDER_CONDITIONAL)||"null";a=Blockly.Arduino.valueToCode(a,"ELSE",Blockly.Arduino.ORDER_CONDITIONAL)||"null";return[b+" ? "+c+" : "+a,Blockly.Arduino.ORDER_CONDITIONAL]};Blockly.Arduino.loops={};
Blockly.Arduino.controls_repeat_ext=function(a){var b=a.getField("TIMES")?String(Number(a.getFieldValue("TIMES"))):Blockly.Arduino.valueToCode(a,"TIMES",Blockly.Arduino.ORDER_ASSIGNMENT)||"0",c=Blockly.Arduino.statementToCode(a,"DO");c=Blockly.Arduino.addLoopTrap(c,a);a="";var d=Blockly.Arduino.variableDB_.getDistinctName("count",Blockly.VARIABLE_CATEGORY_NAME),e=b;b.match(/^\w+$/)||Blockly.isNumber(b)||(e=Blockly.Arduino.variableDB_.getDistinctName("repeat_end",Blockly.VARIABLE_CATEGORY_NAME),a+=
"int "+e+" = "+b+";\n");return a+("for (int "+d+" = 0; "+d+" < "+e+"; "+d+"++) {\n"+c+"}\n")};Blockly.Arduino.controls_repeat=Blockly.Arduino.controls_repeat_ext;Blockly.Arduino.controls_whileUntil=function(a){var b="UNTIL"==a.getFieldValue("MODE"),c=Blockly.Arduino.valueToCode(a,"BOOL",b?Blockly.Arduino.ORDER_LOGICAL_NOT:Blockly.Arduino.ORDER_NONE)||"false",d=Blockly.Arduino.statementToCode(a,"DO");d=Blockly.Arduino.addLoopTrap(d,a);b&&(c="!"+c);return"while ("+c+") {\n"+d+"}\n"};
Blockly.Arduino.controls_for=function(a){var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),c=Blockly.Arduino.valueToCode(a,"FROM",Blockly.Arduino.ORDER_ASSIGNMENT)||"0",d=Blockly.Arduino.valueToCode(a,"TO",Blockly.Arduino.ORDER_ASSIGNMENT)||"0",e=Blockly.Arduino.valueToCode(a,"BY",Blockly.Arduino.ORDER_ASSIGNMENT)||"1",f=Blockly.Arduino.statementToCode(a,"DO");f=Blockly.Arduino.addLoopTrap(f,a);if(Blockly.isNumber(c)&&Blockly.isNumber(d)&&Blockly.isNumber(e)){var g=
Number(c)<=Number(d);a="for (int "+b+" = "+c+"; "+b+(g?" <= ":" >= ")+d+"; "+b;b=Math.abs(Number(e));a=(1==b?a+(g?"++":"--"):a+((g?" += ":" -= ")+b))+(") {\n"+f+"}\n")}else a="",g=c,c.match(/^\w+$/)||Blockly.isNumber(c)||(g=Blockly.Arduino.variableDB_.getDistinctName(b+"_start",Blockly.VARIABLE_CATEGORY_NAME),a+="int "+g+" = "+c+";\n"),c=d,d.match(/^\w+$/)||Blockly.isNumber(d)||(c=Blockly.Arduino.variableDB_.getDistinctName(b+"_end",Blockly.VARIABLE_CATEGORY_NAME),a+="int "+c+" = "+d+";\n"),d=Blockly.Arduino.variableDB_.getDistinctName(b+
"_inc",Blockly.VARIABLE_CATEGORY_NAME),a+="int "+d+" = ",a=Blockly.isNumber(e)?a+(Math.abs(e)+";\n"):a+("abs("+e+");\n"),a=a+("if ("+g+" > "+c+") {\n")+(Blockly.Arduino.INDENT+d+" = -"+d+";\n"),a+="}\n",a+="for (int "+b+" = "+g+"; "+d+" >= 0 ? "+b+" <= "+c+" : "+b+" >= "+c+"; "+b+" += "+d+") {\n"+f+"}\n";return a};
Blockly.Arduino.controls_forEach=function(a){var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),c=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_ASSIGNMENT)||"[]",d=Blockly.Arduino.statementToCode(a,"DO");d=Blockly.Arduino.addLoopTrap(d,a);a="";var e=c;c.match(/^\w+$/)||(e=Blockly.Arduino.variableDB_.getDistinctName(b+"_list",Blockly.VARIABLE_CATEGORY_NAME),a+="int "+e+" = "+c+";\n");c=Blockly.Arduino.variableDB_.getDistinctName(b+"_index",
Blockly.VARIABLE_CATEGORY_NAME);d=Blockly.Arduino.INDENT+b+" = "+e+"["+c+"];\n"+d;return a+("for (int "+c+" in "+e+") {\n"+d+"}\n")};
Blockly.Arduino.controls_flow_statements=function(a){var b="";Blockly.Arduino.STATEMENT_PREFIX&&(b+=Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_PREFIX,a));Blockly.Arduino.STATEMENT_SUFFIX&&(b+=Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_SUFFIX,a));if(Blockly.Arduino.STATEMENT_PREFIX){var c=Blockly.Arduinoonstants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(a);c&&!c.suppressPrefixSuffix&&(b+=Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_PREFIX,c))}switch(a.getFieldValue("FLOW")){case "BREAK":return b+
"break;\n";case "CONTINUE":return b+"continue;\n"}throw Error("Unknown flow statement.");};Blockly.Arduino.math={};Blockly.Arduino.math_number=function(a){a=Number(a.getFieldValue("NUM"));return[a,0<=a?Blockly.Arduino.ORDER_ATOMIC:Blockly.Arduino.ORDER_UNARY_NEGATION]};
Blockly.Arduino.math_arithmetic=function(a){var b={ADD:[" + ",Blockly.Arduino.ORDER_ADDITION],MINUS:[" - ",Blockly.Arduino.ORDER_SUBTRACTION],MULTIPLY:[" * ",Blockly.Arduino.ORDER_MULTIPLICATION],DIVIDE:[" / ",Blockly.Arduino.ORDER_DIVISION],POWER:[null,Blockly.Arduino.ORDER_COMMA]}[a.getFieldValue("OP")],c=b[0];b=b[1];var d=Blockly.Arduino.valueToCode(a,"A",b)||"0";a=Blockly.Arduino.valueToCode(a,"B",b)||"0";return c?[d+c+a,b]:["Math.pow("+d+", "+a+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.math_single=function(a){var b=a.getFieldValue("OP");if("NEG"==b)return a=Blockly.Arduino.valueToCode(a,"NUM",Blockly.Arduino.ORDER_UNARY_NEGATION)||"0","-"==a[0]&&(a=" "+a),["-"+a,Blockly.Arduino.ORDER_UNARY_NEGATION];a="SIN"==b||"COS"==b||"TAN"==b?Blockly.Arduino.valueToCode(a,"NUM",Blockly.Arduino.ORDER_DIVISION)||"0":Blockly.Arduino.valueToCode(a,"NUM",Blockly.Arduino.ORDER_NONE)||"0";switch(b){case "ABS":var c="abs("+a+")";break;case "ROOT":c="sqrt("+a+")";break;case "LN":c="log("+
a+")";break;case "EXP":c="exp("+a+")";break;case "POW10":c="pow(10,"+a+")";break;case "ROUND":c="round("+a+")";break;case "ROUNDUP":c="ceil("+a+")";break;case "ROUNDDOWN":c="floor("+a+")";break;case "SIN":c="sin("+a+" / 180 * PI)";break;case "COS":c="cos("+a+" / 180 * PI)";break;case "TAN":c="tan("+a+" / 180 * PI)"}if(c)return[c,Blockly.Arduino.ORDER_FUNCTION_CALL];switch(b){case "LOG10":c="log("+a+") / Math.log(10)";break;case "ASIN":c="asin("+a+") / PI * 180";break;case "ACOS":c="acos("+a+") / PI * 180";
break;case "ATAN":c="atan("+a+") / PI * 180";break;default:throw Error("Unknown math operator: "+b);}return[c,Blockly.Arduino.ORDER_DIVISION]};Blockly.Arduino.math_constant=function(a){return{PI:["Math.PI",Blockly.Arduino.ORDER_MEMBER],E:["Math.E",Blockly.Arduino.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",Blockly.Arduino.ORDER_DIVISION],SQRT2:["Math.SQRT2",Blockly.Arduino.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",Blockly.Arduino.ORDER_MEMBER],INFINITY:["Infinity",Blockly.Arduino.ORDER_ATOMIC]}[a.getFieldValue("CONSTANT")]};
Blockly.Arduino.math_number_property=function(a){var b=Blockly.Arduino.valueToCode(a,"NUMBER_TO_CHECK",Blockly.Arduino.ORDER_MODULUS)||"0",c=a.getFieldValue("PROPERTY");if("PRIME"==c)return[Blockly.Arduino.provideFunction_("mathIsPrime",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.",
"  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+b+")",Blockly.Arduino.ORDER_FUNCTION_CALL];switch(c){case "EVEN":var d=b+" % 2 == 0";break;case "ODD":d=b+" % 2 == 1";break;case "WHOLE":d=b+" % 1 == 0";break;case "POSITIVE":d=
b+" > 0";break;case "NEGATIVE":d=b+" < 0";break;case "DIVISIBLE_BY":a=Blockly.Arduino.valueToCode(a,"DIVISOR",Blockly.Arduino.ORDER_MODULUS)||"0",d=b+" % "+a+" == 0"}return[d,Blockly.Arduino.ORDER_EQUALITY]};Blockly.Arduino.math_change=function(a){var b=Blockly.Arduino.valueToCode(a,"DELTA",Blockly.Arduino.ORDER_ADDITION)||"0";a=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME);return a+" = "+a+" + "+b+";\n"};Blockly.Arduino.math_round=Blockly.Arduino.math_single;
Blockly.Arduino.math_trig=Blockly.Arduino.math_single;
Blockly.Arduino.math_on_list=function(a){var b=a.getFieldValue("OP");switch(b){case "SUM":a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_MEMBER)||"[]";a+=".reduce(function(x, y) {return x + y;})";break;case "MIN":a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_COMMA)||"[]";a="Math.min.apply(null, "+a+")";break;case "MAX":a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_COMMA)||"[]";a="Math.max.apply(null, "+a+")";break;case "AVERAGE":b=Blockly.Arduino.provideFunction_("mathMean",
["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]);a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_NONE)||"[]";a=b+"("+a+")";break;case "MEDIAN":b=Blockly.Arduino.provideFunction_("mathMedian",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});",
"  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]);a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_NONE)||"[]";a=b+"("+a+")";break;case "MODE":b=Blockly.Arduino.provideFunction_("mathModes",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {",
"    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);",
"    }","  }","  return modes;","}"]);a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_NONE)||"[]";a=b+"("+a+")";break;case "STD_DEV":b=Blockly.Arduino.provideFunction_("mathStandardDeviation",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);",
"  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]);a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_NONE)||"[]";a=b+"("+a+")";break;case "RANDOM":b=Blockly.Arduino.provideFunction_("mathRandomList",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]);a=Blockly.Arduino.valueToCode(a,"LIST",Blockly.Arduino.ORDER_NONE)||"[]";a=b+"("+a+")";break;default:throw Error("Unknown operator: "+
b);}return[a,Blockly.Arduino.ORDER_FUNCTION_CALL]};Blockly.Arduino.math_modulo=function(a){var b=Blockly.Arduino.valueToCode(a,"DIVIDEND",Blockly.Arduino.ORDER_MODULUS)||"0";a=Blockly.Arduino.valueToCode(a,"DIVISOR",Blockly.Arduino.ORDER_MODULUS)||"0";return[b+" % "+a,Blockly.Arduino.ORDER_MODULUS]};
Blockly.Arduino.math_constrain=function(a){a=Blockly.Arduino.valueToCode(this,"x",Blockly.Arduino.ORDER_ATOMIC);var b=Blockly.Arduino.valueToCode(this,"a",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(this,"b",Blockly.Arduino.ORDER_ATOMIC);return["constrain("+a+","+b+","+c+")",Blockly.Arduino.ORDER_NONE]};
Blockly.Arduino.math_random_int=function(a){a=Blockly.Arduino.valueToCode(this,"FROM",Blockly.Arduino.ORDER_ATOMIC);var b=Blockly.Arduino.valueToCode(this,"TO",Blockly.Arduino.ORDER_ATOMIC);return["random("+a+","+b+")",Blockly.Arduino.ORDER_NONE]};Blockly.Arduino.math_random_float=function(a){return["Math.random()",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.math_atan2=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_COMMA)||"0";return["atan2("+(Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_COMMA)||"0")+", "+b+") / PI * 180",Blockly.Arduino.ORDER_DIVISION]};Blockly.Arduino.mygame={};
Blockly.Arduino.mg_begin=function(a){Blockly.Arduino.includes_.include_mg_begin='#include "Wire.h"\n';Blockly.Arduino.definitions_.definition_mg_begin="#define HEIGHT 64\n#define WIDTH 128\n#define WIRE_MAX 30\n#define NEGATIVE 0\n#define POSITIVE 1\n";Blockly.Arduino.variables_.variable_mg_begin='const char Font[96][5] PROGMEM =\n{\n    { 0x00, 0x00, 0x00, 0x00, 0x00 }, // " " 0x20\n    { 0x00, 0x00, 0x4f, 0x00, 0x00 }, // !   0x21\n    { 0x00, 0x07, 0x00, 0x07, 0x00 }, // "   0x22\n    { 0x14, 0x7f, 0x14, 0x7f, 0x14 }, // #   0x23\n    { 0x24, 0x2a, 0x7f, 0x2a, 0x12 }, // $   0x24\n    { 0x23, 0x13, 0x08, 0x64, 0x62 }, // %   0x25\n    { 0x36, 0x49, 0x55, 0x22, 0x50 }, // &   0x26\n    { 0x00, 0x05, 0x03, 0x00, 0x00 }, // \'   0x27\n    { 0x00, 0x1c, 0x22, 0x41, 0x00 }, // (   0x28\n    { 0x00, 0x41, 0x22, 0x1c, 0x00 }, // )   0x29\n    { 0x14, 0x08, 0x3e, 0x08, 0x14 }, // *   0x2A\n    { 0x08, 0x08, 0x3e, 0x08, 0x08 }, // +   0x2B\n    { 0x00, 0x50, 0x30, 0x00, 0x00 }, // ,   0x2C\n    { 0x08, 0x08, 0x08, 0x08, 0x08 }, // -   0x2D\n    { 0x00, 0x60, 0x60, 0x00, 0x00 }, // .   0x2E\n    { 0x20, 0x10, 0x08, 0x04, 0x02 }, // /   0x2F\n    { 0x3e, 0x51, 0x49, 0x45, 0x3e }, // 0   0x30\n    { 0x00, 0x42, 0x7f, 0x40, 0x00 }, // 1   0x31\n    { 0x42, 0x61, 0x51, 0x49, 0x46 }, // 2   0x32\n    { 0x21, 0x41, 0x45, 0x4b, 0x31 }, // 3   0x33\n    { 0x18, 0x14, 0x12, 0x7f, 0x10 }, // 4   0x34\n    { 0x27, 0x45, 0x45, 0x45, 0x39 }, // 5   0x35\n    { 0x3c, 0x4a, 0x49, 0x49, 0x30 }, // 6   0x36\n      { 0x01, 0x71, 0x09, 0x05, 0x03 }, // 7   0x37\n    { 0x36, 0x49, 0x49, 0x49, 0x36 }, // 8   0x38\n    { 0x06, 0x49, 0x49, 0x29, 0x1e }, // 9   0x39\n    { 0x00, 0x36, 0x36, 0x00, 0x00 }, // :   0x3A\n    { 0x00, 0x56, 0x36, 0x00, 0x00 }, // ;   0x3B\n    { 0x08, 0x14, 0x22, 0x41, 0x00 }, // <   0x3C\n    { 0x14, 0x14, 0x14, 0x14, 0x14 }, // =   0x3D\n    { 0x00, 0x41, 0x22, 0x14, 0x08 }, // >   0x3E\n    { 0x02, 0x01, 0x51, 0x09, 0x06 }, // ?   0x3F\n    { 0x32, 0x49, 0x79, 0x41, 0x3e }, // @   0x40\n    { 0x7e, 0x11, 0x11, 0x11, 0x7e }, // A   0x41\n    { 0x7f, 0x49, 0x49, 0x49, 0x36 }, // B   0x42\n    { 0x3e, 0x41, 0x41, 0x41, 0x22 }, // C   0x43\n    { 0x7f, 0x41, 0x41, 0x22, 0x1c }, // D   0x44\n    { 0x7f, 0x49, 0x49, 0x49, 0x41 }, // E   0x45\n    { 0x7f, 0x09, 0x09, 0x09, 0x01 }, // F   0x46\n    { 0x3e, 0x41, 0x49, 0x49, 0x7a }, // G   0x47\n    { 0x7f, 0x08, 0x08, 0x08, 0x7f }, // H   0x48\n    { 0x00, 0x41, 0x7f, 0x41, 0x00 }, // I   0x49\n    { 0x20, 0x40, 0x41, 0x3f, 0x01 }, // J   0x4A\n    { 0x7f, 0x08, 0x14, 0x22, 0x41 }, // K   0x4B\n    { 0x7f, 0x40, 0x40, 0x40, 0x40 }, // L   0x4C\n    { 0x7f, 0x02, 0x0c, 0x02, 0x7f }, // M   0x4D\n    { 0x7f, 0x04, 0x08, 0x10, 0x7f }, // N   0x4E\n    { 0x3e, 0x41, 0x41, 0x41, 0x3e }, // O   0x4F\n    { 0x7f, 0x09, 0x09, 0x09, 0x06 }, // P   0X50\n    { 0x3e, 0x41, 0x51, 0x21, 0x5e }, // Q   0X51\n    { 0x7f, 0x09, 0x19, 0x29, 0x46 }, // R   0X52\n    { 0x46, 0x49, 0x49, 0x49, 0x31 }, // S   0X53\n    { 0x01, 0x01, 0x7f, 0x01, 0x01 }, // T   0X54\n    { 0x3f, 0x40, 0x40, 0x40, 0x3f }, // U   0X55\n    { 0x1f, 0x20, 0x40, 0x20, 0x1f }, // V   0X56\n    { 0x3f, 0x40, 0x38, 0x40, 0x3f }, // W   0X57\n    { 0x63, 0x14, 0x08, 0x14, 0x63 }, // X   0X58\n    { 0x07, 0x08, 0x70, 0x08, 0x07 }, // Y   0X59\n    { 0x61, 0x51, 0x49, 0x45, 0x43 }, // Z   0X5A\n    { 0x00, 0x7f, 0x41, 0x41, 0x00 }, // [   0X5B\n    { 0x02, 0x04, 0x08, 0x10, 0x20 }, //  0X5C\n    { 0x00, 0x41, 0x41, 0x7f, 0x00 }, // ]   0X5D\n    { 0x04, 0x02, 0x01, 0x02, 0x04 }, // ^   0X5E\n    { 0x40, 0x40, 0x40, 0x40, 0x40 }, // _   0X5F\n    { 0x00, 0x01, 0x02, 0x04, 0x00 }, // `   0X60\n    { 0x20, 0x54, 0x54, 0x54, 0x78 }, // a   0X61\n    { 0x7f, 0x48, 0x44, 0x44, 0x38 }, // b   0X62\n    { 0x38, 0x44, 0x44, 0x44, 0x20 }, // c   0X63\n    { 0x38, 0x44, 0x44, 0x48, 0x7f }, // d   0X64\n    { 0x38, 0x54, 0x54, 0x54, 0x18 }, // e   0X65\n    { 0x08, 0x7e, 0x09, 0x01, 0x02 }, // f   0X66\n    { 0x0c, 0x52, 0x52, 0x52, 0x3e }, // g   0X67\n    { 0x7f, 0x08, 0x04, 0x04, 0x78 }, // h   0X68\n    { 0x00, 0x44, 0x7d, 0x40, 0x00 }, // i   0X69\n    { 0x20, 0x40, 0x44, 0x3d, 0x00 }, // j   0X6A\n    { 0x7f, 0x10, 0x28, 0x44, 0x00 }, // k   0X6B\n    { 0x00, 0x41, 0x7f, 0x40, 0x00 }, // l   0X6C\n    { 0x7c, 0x04, 0x18, 0x04, 0x78 }, // m   0X6D\n    { 0x7c, 0x08, 0x04, 0x04, 0x78 }, // n   0X6E\n    { 0x38, 0x44, 0x44, 0x44, 0x38 }, // o   0X6F\n    { 0x7c, 0x14, 0x14, 0x14, 0x08 }, // p   0X70\n    { 0x08, 0x14, 0x14, 0x18, 0x7c }, // q   0X71\n    { 0x7c, 0x08, 0x04, 0x04, 0x08 }, // r   0X72\n    { 0x48, 0x54, 0x54, 0x54, 0x20 }, // s   0X73\n    { 0x04, 0x3f, 0x44, 0x40, 0x20 }, // t   0X74\n    { 0x3c, 0x40, 0x40, 0x20, 0x7c }, // u   0X75\n    { 0x1c, 0x20, 0x40, 0x20, 0x1c }, // v   0X76\n    { 0x3c, 0x40, 0x30, 0x40, 0x3c }, // w   0X77\n    { 0x44, 0x28, 0x10, 0x28, 0x44 }, // x   0X78\n    { 0x0c, 0x50, 0x50, 0x50, 0x3c }, // y   0X79\n    { 0x44, 0x64, 0x54, 0x4c, 0x44 }, // z   0X7A\n    { 0x00, 0x08, 0x36, 0x41, 0x00 }, // {   0X7B\n    { 0x00, 0x00, 0x7f, 0x00, 0x00 }, // |   0X7C\n    { 0x00, 0x41, 0x36, 0x08, 0x00 }, // }   0X7D\n    { 0x08, 0x08, 0x2a, 0x1c, 0x08 }, // ->  0X7E\n    { 0x08, 0x1c, 0x2a, 0x08, 0x08 } // <-  0X7F\n\n  };\nconst uint8_t OLED_I2C_ADDRES = 0x3C;\nuint8_t buf[128*8];\nvolatile uint8_t btnState, prevBtnState;\nuint32_t nextFrameMillis;\n';Blockly.Arduino.userFunctions_.userfunction_mg_begin=
"void init_SSD1306(){\n  Wire.beginTransmission(OLED_I2C_ADDRES);\n    Wire.write(0x80); Wire.write(0xAE); //set display off\n    Wire.write(0x00); Wire.write(0xA8); Wire.write(0x3F); //set multiplex ratio\n    Wire.write(0x00); Wire.write(0xD3); Wire.write(0x00); //set display offset\n    Wire.write(0x80); Wire.write(0x40); //set display start line\n    Wire.write(0x80); Wire.write(0xA0); //set segment re-map\n    Wire.write(0x80); Wire.write(0xC0); //set com output scan direction\n    Wire.write(0x00); Wire.write(0xDA); Wire.write(0x12); //set com pins hardware configuration\n    Wire.write(0x00); Wire.write(0x81); Wire.write(0x7F); //set contrast control\n    Wire.write(0x80); Wire.write(0xA4); //entire display on\n    Wire.write(0x80); Wire.write(0xA6); //set normal/inverse display\n    Wire.write(0x00); Wire.write(0xD5); Wire.write(0x80); //set display clock\n  Wire.endTransmission();\n  Wire.beginTransmission(OLED_I2C_ADDRES);\n    Wire.write(0x00); Wire.write(0x20); Wire.write(0b00); //horizontal addressing mode\n    Wire.write(0x00); Wire.write(0x22); Wire.write(0);  Wire.write(7);  //page 0-7\n    Wire.write(0x00); Wire.write(0x21); Wire.write(0);  Wire.write(127);  //colum 0-127\n    Wire.write(0x00); Wire.write(0x8D); Wire.write(0x14);\n    Wire.write(0x80); Wire.write(0xAF); //set display on\n  Wire.endTransmission();\n}\n\nboolean btn_Check(uint8_t btn){\n  return PIND & btn;\n}\n\nboolean btn_Pressed(uint8_t btn){\n  if(((prevBtnState & btn) == 0) && ((btnState & btn) != 0)) {return true;}\n  else {return false;}\n}\n\nvoid clear_All(){\n  memset(buf, 0, WIDTH * HEIGHT / 8);\n}\n\nvoid fill_All(){\n  memset(buf, 0xff, sizeof(buf));\n}\n\nvoid draw_Bitmap(uint8_t x, uint8_t y, float sx, float sy, uint16_t *bmp, uint8_t row, uint8_t col, uint8_t wb ){\n  /*if ((x >= WIDTH) || (y >= HEIGHT) || ((x + 8 * sx - 1) < 0) || ((y + 8 * sy - 1) < 0)) {\n    return;\n  }*/\n  uint16_t colum;\n  for (int8_t i=0; i<col; i++ ) {\n    colum = bmp[i];\n    for (int8_t j = 0; j<row; j++) {\n      uint16_t dot = (colum & 0x1) ? true : false;\n      for (uint8_t a = 0; a < sx; a++ ) {\n        for (uint8_t b = 0; b < sy; b++ ) {\n         draw_Pixel(x + (i * sx) + a, y + (j * sy) + b, wb ? dot : !dot);\n        }\n      }\n      colum >>= 1;\n    }\n  }\n}\n\nvoid draw_String(uint8_t x, uint8_t y, String s, float size,  uint8_t wb ){\n  /*if ((x >= WIDTH) || (y >= HEIGHT) || ((x + 5 * size - 1) < 0) || ((y + 8 * size - 1) < 0)) {\n    return;\n  }*/\n  int8_t ii=0;\n  for (uint8_t i=0; i<s.length(); i++ ) {\n    if(s.charAt(i)=='\\\\'){\n      y+=8*size;\n      ii=0;\n    }else{\n      draw_Char(x+8*size*ii,y,s.charAt(i),size, wb);\n      ii++;\n    }\n  }\n}\n\nvoid draw_Char(uint8_t x, uint8_t y, char c, float size,  uint8_t wb ){\n  /*if ((x >= WIDTH) || (y >= HEIGHT) || ((x + 5 * size - 1) < 0) || ((y + 8 * size - 1) < 0)) {\n    return;\n  }*/\n  char colum;\n  for (int8_t i=0; i<5; i++ ) {\n    colum = pgm_read_byte(&Font[c-0x20][i]);\n    for (int8_t j = 0; j<8; j++) {\n      uint8_t dot = (colum & 0x1) ? true : false;\n      for (uint8_t a = 0; a < size; a++ ) {\n        for (uint8_t b = 0; b < size; b++ ) {\n          draw_Pixel(x + (i * size) + a, y + (j * size) + b, wb ? dot : !dot);\n        }\n      }\n      colum >>= 1;\n    }\n  }\n}\n\nvoid draw_Num(uint8_t x, uint8_t y, int16_t n, float size,  uint8_t wb ){\n  /*if ((x >= WIDTH) || (y >= HEIGHT) || ((x + 5 * size - 1) < 0) || ((y + 8 * size - 1) < 0)) {\n    return;\n  }*/\n  int8_t d;\n  uint8_t p=0;\n  if(n<0){draw_Char(x+8*size*p,y,'-',size,wb);p++;n=-n;}\n  d = n/10000;\n  if(d){draw_Char(x+8*size*p,y,d+0x30,size,wb);p++;}\n  n %= 10000;\n  d = n/1000;\n  if(d){draw_Char(x+8*size*p,y,d+0x30,size,wb);p++;}\n  n %= 1000;\n  d = n/100;\n  if(d){draw_Char(x+8*size*p,y,d+0x30,size,wb);p++;}\n  n %= 100;\n  d = n/10;\n  if(d){draw_Char(x+8*size*p,y,d+0x30,size,wb);p++;}\n  n %= 10;\n  d = n;\n  draw_Char(x+8*size*p,y,d+0x30,size,wb);\n}\n \nvoid fill_Ellipse( uint8_t x, uint8_t y, uint8_t rx, uint8_t ry, int wb )\n{\n  int8_t xt, x1, yt, y1, r;\n  if (rx > ry) {\n    xt=r=rx; yt=0;\n    while (xt>=yt) {\n      x1=xt*ry/rx;\n      y1=yt*ry/rx;\n      draw_Fast_HLine(x-xt, y+y1, 2*xt, wb);\n      draw_Fast_HLine(x-xt, y-y1, 2*xt, wb);\n      draw_Fast_HLine(x-yt, y+x1, 2*yt, wb);\n      draw_Fast_HLine(x-yt, y-x1, 2*yt, wb);\n      if ((r -= yt++ * 2 + 1) <= 0) r += --xt * 2;\n    }\n  } else {\n    xt=r=ry; yt=0;\n    while (xt>=yt) {\n      x1=xt*rx/ry;\n      y1=yt*rx/ry;\n      draw_Fast_VLine(x+x1, y-yt, 2*yt, wb);\n      draw_Fast_VLine(x-x1, y-yt, 2*yt, wb);\n      draw_Fast_VLine(x+y1, y-xt, 2*xt, wb);\n      draw_Fast_VLine(x-y1, y-xt, 2*xt, wb);\n      if ((r -= yt++ * 2 + 1) <= 0) r += --xt * 2;\n    }\n  }\n}\n\nvoid draw_Ellipse( uint8_t x, uint8_t y, uint8_t rx, uint8_t ry, int wb )\n{\n  int8_t xt, x1, yt, y1, r;\n  if (rx > ry) {\n    xt=r=rx; yt=0;\n    while (xt>=yt) {\n      x1=xt*ry/rx;\n      y1=yt*ry/rx;\n      draw_Pixel(x+xt, y+y1, wb);\n      draw_Pixel(x+xt, y-y1, wb);\n      draw_Pixel(x-xt, y+y1, wb);\n      draw_Pixel(x-xt, y-y1, wb);\n      draw_Pixel(x+yt, y+x1, wb);\n      draw_Pixel(x+yt, y-x1, wb);\n      draw_Pixel(x-yt, y+x1, wb);\n      draw_Pixel(x-yt, y-x1, wb);\n      if ((r -= yt++ * 2 + 1) <= 0) r += --xt * 2;\n    }\n  } else {\n    xt=r=ry; yt=0;\n    while (xt>=yt) {\n      x1=xt*rx/ry;\n      y1=yt*rx/ry;\n      draw_Pixel(x+x1, y+yt, wb);\n      draw_Pixel(x+x1, y-yt, wb);\n      draw_Pixel(x-x1, y+yt, wb);\n      draw_Pixel(x-x1, y-yt, wb);\n      draw_Pixel(x+y1, y+xt, wb);\n      draw_Pixel(x+y1, y-xt, wb);\n      draw_Pixel(x-y1, y+xt, wb);\n      draw_Pixel(x-y1, y-xt, wb);\n      if ((r -= yt++ * 2 + 1) <= 0) r += --xt * 2;\n    }\n  }\n}\n\nvoid fill_CornerR(uint8_t x, uint8_t y, uint8_t rad, uint8_t corner, uint8_t length, boolean wb){\n  int8_t cx = rad;\n  int8_t cy = 0;\n  int8_t F = -2 * rad + 3;\n\n  while ( cx >= cy ) {\n    if (corner & 0x1) {\n      draw_Fast_VLine( x + cx, y - cy, 2*cy+length, wb );\n      draw_Fast_VLine( x + cy, y - cx, 2*cx+length, wb );\n    }\n    if (corner & 0x2) {\n      draw_Fast_VLine( x - cx, y - cy, 2*cy+length, wb );\n      draw_Fast_VLine( x - cy, y - cx, 2*cx+length, wb );\n    }\n    if ( F >= 0 ) {\n      cx--;\n      F -= 4 * cx;\n    }\n    cy++;\n    F += 4 * cy + 2;\n  }\n}\n\nvoid fill_Circle(int8_t x, int8_t y, uint8_t rad, uint8_t wb){\n  int16_t cx = rad;\n  int16_t cy = 0;\n  int16_t F = -2 * rad + 3;\n\n  while ( cx >= cy ) {\n    draw_Line(constrain(cy + x,0,127), cx + y, constrain(-cy + x,0,127), cx + y,wb);\n    draw_Line(constrain(cx + x,0,127), cy + y, constrain(-cx + x,0,127), cy + y,wb);\n    draw_Line(constrain(-cy + x,0,127), -cx + y, constrain(cy + x,0,127), -cx + y,wb);\n    draw_Line(constrain(-cx + x,0,127), -cy + y, constrain(cx + x,0,127), -cy + y,wb);\n    if ( F >= 0 ) {\n      cx--;\n      F -= 4 * cx;\n    }\n    cy++;\n    F += 4 * cy + 2;\n  }\n}\n\nvoid draw_CornerR(uint8_t x, uint8_t y, uint8_t rad, uint8_t corner, boolean wb){\n  int8_t cx = rad;\n  int8_t cy = 0;\n  int8_t F = -2 * rad + 3;\n\n  while ( cx >= cy ) {\n    if (corner & 0x4) {\n      draw_Pixel( x + cx, y + cy, wb );\n      draw_Pixel( x + cy, y + cx, wb );\n    }\n    if (corner & 0x2) {\n      draw_Pixel( x + cx, y - cy, wb );\n      draw_Pixel( x + cy, y - cx, wb );\n    }\n    if (corner & 0x8) {\n      draw_Pixel( x - cy, y + cx, wb );\n      draw_Pixel( x - cx, y + cy, wb );\n    }\n    if (corner & 0x1) {\n      draw_Pixel( x - cy, y - cx, wb );\n      draw_Pixel( x - cx, y - cy, wb );\n    }\n    if ( F >= 0 ) {\n      cx--;\n      F -= 4 * cx;\n    }\n    cy++;\n    F += 4 * cy + 2;\n  }\n}\n\nvoid draw_Circle(int8_t x, int8_t y, uint8_t rad, boolean wb){\n  int16_t cx = rad;\n  int16_t cy = 0;\n  int16_t F = -2 * rad + 3;\n\n  while ( cx >= cy ) {\n    draw_Pixel( x + cx, y + cy, wb );\n    draw_Pixel( x - cx, y + cy, wb );\n    draw_Pixel( x + cx, y - cy, wb );\n    draw_Pixel( x - cx, y - cy, wb );\n    draw_Pixel( x + cy, y + cx, wb );\n    draw_Pixel( x - cy, y + cx, wb );\n    draw_Pixel( x + cy, y - cx, wb );\n    draw_Pixel( x - cy, y - cx, wb );\n    if ( F >= 0 ) {\n      cx--;\n      F -= 4 * cx;\n    }\n    cy++;\n    F += 4 * cy + 2;\n  }\n}\n\nvoid fill_RoundRect(uint8_t x, uint8_t y, uint8_t w, uint8_t h, uint8_t r, uint8_t wb){\n  fill_Rect(x+r, y, w-2*r, h, wb);\n  fill_CornerR(x+w-r-1, y+r, r, 1, h-2*r-1, wb);\n  fill_CornerR(x+r, y+r, r, 2, h-2*r-1, wb);\n}\n\nvoid fill_Rect(uint8_t x, uint8_t y, uint8_t w, uint8_t h, uint8_t wb){\n  for(int i=x; i<x+w; i++){\n    draw_Fast_VLine(i, y, h, wb);\n  }\n}\n\nvoid draw_RoundRect(uint8_t x, uint8_t y, uint8_t w, uint8_t h, uint8_t r, uint8_t wb){\n  draw_Fast_HLine(x+r, y, w-2*r, wb);\n  draw_Fast_HLine(x+r, y+h-1, w-2*r, wb);\n  draw_Fast_VLine(x, y+r, h-2*r, wb);\n  draw_Fast_VLine(x+w-1, y+r, h-2*r, wb);\n\n  draw_CornerR(x+r, y+r, r, 1, wb);\n  draw_CornerR(x+w-r-1, y+r, r, 2, wb);\n  draw_CornerR(x+w-r-1, y+h-r-1, r, 4, wb);\n  draw_CornerR(x+r, y+h-r-1, r, 8, wb);\n}\n\nvoid draw_Rect(uint8_t x, uint8_t y, uint8_t w, uint8_t h, uint8_t wb){\n  draw_Fast_HLine(x, y, w, wb);\n  draw_Fast_HLine(x, y+h-1, w, wb);\n  draw_Fast_VLine(x, y, h, wb);\n  draw_Fast_VLine(x+w-1, y, h, wb);\n}\n\nvoid draw_Fast_VLine(int8_t x, int8_t y, uint8_t h, boolean pos_neg){\n  for (int i = max(0,y); i < min(y+h,HEIGHT); i++){\n    draw_Pixel(x,i,pos_neg);\n  }\n}\n\nvoid draw_Fast_HLine(int8_t x, int8_t y, uint8_t w, boolean pos_neg){\n  for (int i = max(0,x); i < min(x+w,WIDTH); i++){\n    draw_Pixel(i,y,pos_neg);\n  }\n}\n\nvoid draw_Line(uint8_t x0, uint8_t y0, uint8_t x1, uint8_t y1, boolean pos_neg){\n  uint8_t temp;\n  uint8_t x, y;\n  uint8_t ystep;\n\n  uint8_t inclination = (abs(y1 - y0) > abs(x1 - x0));\n  if(inclination){\n    temp = x0; x0 = y0; y0= temp;\n    temp = x1; x1 = y1; y1= temp;\n  }\n  if(x0 > x1){\n    temp = x0; x0 = x1; x1= temp;\n    temp = y0; y0 = y1; y1= temp;\n  }\n  uint8_t deltaX = x1 - x0;\n  uint8_t deltaY = abs(y1 - y0);\n  int dummyY = deltaX/2;\n  y = y0;\n  if(y0 < y1)ystep = 1; else ystep = -1;\n  for(x = x0; x < x1; x++){\n    if(inclination) draw_Pixel(y, x, pos_neg); else draw_Pixel(x, y, pos_neg);\n    dummyY -= deltaY;\n    if(dummyY < 0){\n      y += ystep;\n      dummyY += deltaX;\n    }\n  }\n}\n\nvoid draw_Pixel(uint8_t x, uint8_t y, boolean pos_neg){\n  x=127-x;\n  y=63-y;\n  if( x>127 || y>63)return;\n  if(pos_neg) buf[x + (y/8)*WIDTH] |=  (1 << (y&7));  //set 1 to segment after bit shift\n  else buf[x + (y/8)*WIDTH] &= ~(1 << (y&7));  //set 0 to segment after bit shift\n}\n\nvoid flash(){\n  uint16_t count = 0;\n  uint8_t bytesOut = 1;\n\n  Wire.beginTransmission(OLED_I2C_ADDRES);\n  Wire.write(0b01000000);\n  //send byte data for all segments\n  while(count<128*8) {\n    if(bytesOut >= WIRE_MAX) {\n      Wire.endTransmission();\n    Wire.beginTransmission(OLED_I2C_ADDRES);\n    Wire.write(0b01000000);\n    bytesOut = 1;\n  }\n  Wire.write(buf[count]);\n  count++;\n  bytesOut++;\n}\nWire.endTransmission();\n}\nbool update(uint8_t interval){\n if ((nextFrameMillis - millis()) > interval){\n    nextFrameMillis = millis() + interval;\n    prevBtnState = btnState;\n    btnState = PIND & 0xff;\n    return true;\n  }else{\n    return false;\n  }\n}\n";
Blockly.Arduino.setups_.setup_mg_begin="//int i,j,k;\nWire.begin();\nWire.setClock(400000);\ndelay(100);\ninit_SSD1306();\nfor(int i=0;i<128*64/8;i++)buf[i]=0;\n";return""};Blockly.Arduino.mg_width=function(a){return["(int)WIDTH",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.mg_height=function(a){return["(int)HEIGHT",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.mg_clear_all=function(a){return"true"==Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC)?"fill_All();\n":"clear_All();\n"};
Blockly.Arduino.mg_flash=function(a){return"flash();\n"};Blockly.Arduino.mg_update=function(a){return"while(!update("+a.getFieldValue("INTERVAL")+"));\n"};Blockly.Arduino.mg_draw_pixel=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Pixel("+b+","+c+","+a+");\n"};
Blockly.Arduino.mg_draw_line=function(a){var b=Blockly.Arduino.valueToCode(a,"X0",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y0",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"X1",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"Y1",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Line("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_draw_fast_vline=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"H",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Fast_VLine("+b+","+c+","+d+","+a+");\n"};
Blockly.Arduino.mg_draw_fast_hline=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"W",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Fast_HLine("+b+","+c+","+d+","+a+");\n"};
Blockly.Arduino.mg_draw_rect=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"W",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"H",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Rect("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_draw_round_rect=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"W",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"H",Blockly.Arduino.ORDER_ATOMIC),f=Blockly.Arduino.valueToCode(a,"R",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_RoundRect("+b+","+c+","+d+","+e+","+f+","+
a+");\n"};Blockly.Arduino.mg_fill_rect=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"W",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"H",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"fill_Rect("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_fill_round_rect=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"W",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"H",Blockly.Arduino.ORDER_ATOMIC),f=Blockly.Arduino.valueToCode(a,"R",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"fill_RoundRect("+b+","+c+","+d+","+e+","+f+","+
a+");\n"};Blockly.Arduino.mg_draw_circle=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"R",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Circle("+b+","+c+","+d+","+a+");\n"};
Blockly.Arduino.mg_fill_circle=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"R",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"fill_Circle("+b+","+c+","+d+","+a+");\n"};
Blockly.Arduino.mg_draw_ellipse=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"A",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"B",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Ellipse("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_fill_ellipse=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"A",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"B",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"fill_Ellipse("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_draw_string=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"C",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"S",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_String("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_draw_char=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"C",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"S",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Char("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_draw_num=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"C",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"S",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Num("+b+","+c+","+d+","+e+","+a+");\n"};
Blockly.Arduino.mg_draw_bitmap=function(a){var b=Blockly.Arduino.valueToCode(a,"X",Blockly.Arduino.ORDER_ATOMIC),c=Blockly.Arduino.valueToCode(a,"Y",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"W",Blockly.Arduino.ORDER_ATOMIC),e=Blockly.Arduino.valueToCode(a,"H",Blockly.Arduino.ORDER_ATOMIC),f=Blockly.Arduino.variableDB_.getName(a.getFieldValue("BMP"),Blockly.Variables.NAME_TYPE);a=Blockly.Arduino.valueToCode(a,"W/B",Blockly.Arduino.ORDER_ATOMIC);return"draw_Bitmap("+b+","+c+","+
d+","+e+","+f+","+f+"Row, "+f+"Col,"+a+");\n"};
Blockly.Arduino.mg_create_bitmap=function(a){for(var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),c=a.getFieldValue("rowInput"),d=a.getFieldValue("colInput"),e=Array(c*d),f=0;f<c;f++)for(var g=0;g<d;g++)"TRUE"==a.getFieldValue("e"+String(f)+"_"+String(g))?e[f*d+g]=1:e[f*d+g]=0;a=Array(d);for(g=0;g<d;g++)for(f=a[g]=0;f<c;f++)a[g]+=e[f*d+g]<<f;e="uint16_t "+b+"["+d+"] = {";for(g=0;g<d-1;g++)e+=a[g]+",";e+=a[d-1]+"};\n";Blockly.Arduino.variables_[b]=e+("uint8_t "+
b+"Row = "+c+";\nuint8_t ")+(b+"Col = "+d+";\n");return""};Blockly.Arduino.mg_button_check=function(a){var b=0;switch(a.getFieldValue("BTN")){case "A_BTN":b=128;break;case "B_BTN":b=64;break;case "U_BTN":b=16;break;case "D_BTN":b=32;break;case "L_BTN":b=4;break;case "R_BTN":b=8}return["btn_Check("+b+")\n",Blockly.Arduino.ORDER_ATOMIC]};
Blockly.Arduino.mg_button_pressed=function(a){var b=0;switch(a.getFieldValue("BTN")){case "A_BTN":b=128;break;case "B_BTN":b=64;break;case "U_BTN":b=16;break;case "D_BTN":b=32;break;case "L_BTN":b=4;break;case "R_BTN":b=8}return["btn_Pressed("+b+")\n",Blockly.Arduino.ORDER_ATOMIC]};
Blockly.Arduino.mg_array_create=function(a){for(var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),c=a.getFieldValue("rowInput"),d=a.getFieldValue("colInput"),e=a.getFieldValue("TYPE")+" "+b+"["+c+"]["+d+"] = {",f=0;f<c;f++){e+="{";for(var g=0;g<d-1;g++)e+=a.getFieldValue("e"+String(f)+"-"+String(g)),e+=",";e+=a.getFieldValue("e"+String(f)+"-"+String(d-1));e+="},"}e=e.slice(0,-1);Blockly.Arduino.variables_[b]=e+"};";return""};
Blockly.Arduino.mg_array_set=function(a){var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),c=Blockly.Arduino.valueToCode(a,"Row",Blockly.Arduino.ORDER_ATOMIC),d=Blockly.Arduino.valueToCode(a,"Col",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"Val",Blockly.Arduino.ORDER_ATOMIC);return b+"["+c+"]["+d+"] = "+a+";"};
Blockly.Arduino.mg_array_get=function(a){var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),c=Blockly.Arduino.valueToCode(a,"Row",Blockly.Arduino.ORDER_ATOMIC);a=Blockly.Arduino.valueToCode(a,"Col",Blockly.Arduino.ORDER_ATOMIC);return[b+"["+c+"]["+a+"]",Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.procedures={};
Blockly.Arduino.procedures_defreturn=function(a){var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("NAME"),Blockly.PROCEDURE_CATEGORY_NAME),c="";Blockly.Arduino.STATEMENT_PREFIX&&(c+=Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_PREFIX,a));Blockly.Arduino.STATEMENT_SUFFIX&&(c+=Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_SUFFIX,a));c&&(c=Blockly.Arduino.prefixLines(c,Blockly.Arduino.INDENT));var d="";Blockly.Arduino.INFINITE_LOOP_TRAP&&(d=Blockly.Arduino.prefixLines(Blockly.Arduino.injectId(Blockly.Arduino.INFINITE_LOOP_TRAP,a),
Blockly.Arduino.INDENT));var e=Blockly.Arduino.statementToCode(a,"STACK"),f=Blockly.Arduino.valueToCode(a,"RETURN",Blockly.Arduino.ORDER_NONE)||"",g="";e&&f&&(g=c);f&&(f=Blockly.Arduino.INDENT+"return "+f+";\n");for(var h=f?"int":"void",l=[],m=a.getVars(),k=0;k<m.length;k++)l[k]="int "+Blockly.Arduino.variableDB_.getName(m[k],Blockly.VARIABLE_CATEGORY_NAME);c=h+" "+b+"("+l.join(", ")+") {\n"+c+d+e+g+f+"}";c=Blockly.Arduino.scrub_(a,c);Blockly.Arduino.userFunctions_["%"+b]=c;return null};
Blockly.Arduino.procedures_defnoreturn=Blockly.Arduino.procedures_defreturn;Blockly.Arduino.procedures_callreturn=function(a){for(var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("NAME"),Blockly.PROCEDURE_CATEGORY_NAME),c=[],d=a.getVars(),e=0;e<d.length;e++)c[e]=Blockly.Arduino.valueToCode(a,"ARG"+e,Blockly.Arduino.ORDER_COMMA)||"null";return[b+"("+c.join(", ")+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.procedures_callnoreturn=function(a){return Blockly.Arduino.procedures_callreturn(a)[0]+";\n"};
Blockly.Arduino.procedures_ifreturn=function(a){var b="if ("+(Blockly.Arduino.valueToCode(a,"CONDITION",Blockly.Arduino.ORDER_NONE)||"false")+") {\n";Blockly.Arduino.STATEMENT_SUFFIX&&(b+=Blockly.Arduino.prefixLines(Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_SUFFIX,a),Blockly.Arduino.INDENT));a.hasReturnValue_?(a=Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_NONE)||"null",b+=Blockly.Arduino.INDENT+"return "+a+";\n"):b+=Blockly.Arduino.INDENT+"return;\n";return b+"}\n"};Blockly.Arduino.texts={};Blockly.Arduino.text=function(a){return[Blockly.Arduino.quote_(a.getFieldValue("TEXT")),Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.text_multiline=function(a){a=Blockly.Arduino.multiline_quote_(a.getFieldValue("TEXT"));-1!=a.indexOf("\n")&&(a="("+a+")");return[a,Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.text.forceString_=function(a){return Blockly.Arduino.text.forceString_.strRegExp.test(a)?a:"String("+a+")"};Blockly.Arduino.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/;
Blockly.Arduino.text_join=function(a){switch(a.itemCount_){case 0:return["''",Blockly.Arduino.ORDER_ATOMIC];case 1:return a=Blockly.Arduino.valueToCode(a,"ADD0",Blockly.Arduino.ORDER_NONE)||"''",a=Blockly.Arduino.text.forceString_(a),[a,Blockly.Arduino.ORDER_FUNCTION_CALL];case 2:var b=Blockly.Arduino.valueToCode(a,"ADD0",Blockly.Arduino.ORDER_NONE)||"''";a=Blockly.Arduino.valueToCode(a,"ADD1",Blockly.Arduino.ORDER_NONE)||"''";a=Blockly.Arduino.text.forceString_(b)+" + "+Blockly.Arduino.text.forceString_(a);
return[a,Blockly.Arduino.ORDER_ADDITION];default:b=Array(a.itemCount_);for(var c=0;c<a.itemCount_;c++)b[c]=Blockly.Arduino.valueToCode(a,"ADD"+c,Blockly.Arduino.ORDER_COMMA)||"''";a="["+b.join(",")+"].join('')";return[a,Blockly.Arduino.ORDER_FUNCTION_CALL]}};
Blockly.Arduino.text_append=function(a){var b=Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME);a=Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_NONE)||"''";return b+" += "+Blockly.Arduino.text.forceString_(a)+";\n"};Blockly.Arduino.text_length=function(a){return[(Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_FUNCTION_CALL)||"''")+".length",Blockly.Arduino.ORDER_MEMBER]};
Blockly.Arduino.text_isEmpty=function(a){return["!"+(Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_MEMBER)||"''")+".length",Blockly.Arduino.ORDER_LOGICAL_NOT]};
Blockly.Arduino.text_indexOf=function(a){var b="FIRST"==a.getFieldValue("END")?"indexOf":"lastIndexOf",c=Blockly.Arduino.valueToCode(a,"FIND",Blockly.Arduino.ORDER_NONE)||"''";b=(Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_MEMBER)||"''")+"."+b+"("+c+")";return a.workspace.options.oneBasedIndex?[b+" + 1",Blockly.Arduino.ORDER_ADDITION]:[b,Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.text_charAt=function(a){var b=a.getFieldValue("WHERE")||"FROM_START",c=Blockly.Arduino.valueToCode(a,"VALUE","RANDOM"==b?Blockly.Arduino.ORDER_NONE:Blockly.Arduino.ORDER_MEMBER)||"''";switch(b){case "FIRST":return[c+".charAt(0)",Blockly.Arduino.ORDER_FUNCTION_CALL];case "LAST":return[c+".slice(-1)",Blockly.Arduino.ORDER_FUNCTION_CALL];case "FROM_START":return a=Blockly.Arduino.getAdjusted(a,"AT"),[c+".charAt("+a+")",Blockly.Arduino.ORDER_FUNCTION_CALL];case "FROM_END":return a=Blockly.Arduino.getAdjusted(a,
"AT",1,!0),[c+".slice("+a+").charAt(0)",Blockly.Arduino.ORDER_FUNCTION_CALL];case "RANDOM":return[Blockly.Arduino.provideFunction_("textRandomLetter",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+c+")",Blockly.Arduino.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).");};
Blockly.Arduino.text.getIndex_=function(a,b,c){return"FIRST"==b?"0":"FROM_END"==b?a+".length - 1 - "+c:"LAST"==b?a+".length - 1":c};
Blockly.Arduino.text_getSubstring=function(a){var b=Blockly.Arduino.valueToCode(a,"STRING",Blockly.Arduino.ORDER_FUNCTION_CALL)||"''",c=a.getFieldValue("WHERE1"),d=a.getFieldValue("WHERE2");if("FIRST"!=c||"LAST"!=d)if(b.match(/^'?\w+'?$/)||"FROM_END"!=c&&"LAST"!=c&&"FROM_END"!=d&&"LAST"!=d){switch(c){case "FROM_START":var e=Blockly.Arduino.getAdjusted(a,"AT1");break;case "FROM_END":e=Blockly.Arduino.getAdjusted(a,"AT1",1,!1,Blockly.Arduino.ORDER_SUBTRACTION);e=b+".length - "+e;break;case "FIRST":e=
"0";break;default:throw Error("Unhandled option (text_getSubstring).");}switch(d){case "FROM_START":a=Blockly.Arduino.getAdjusted(a,"AT2",1);break;case "FROM_END":a=Blockly.Arduino.getAdjusted(a,"AT2",0,!1,Blockly.Arduino.ORDER_SUBTRACTION);a=b+".length - "+a;break;case "LAST":a=b+".length";break;default:throw Error("Unhandled option (text_getSubstring).");}b=b+".slice("+e+", "+a+")"}else{e=Blockly.Arduino.getAdjusted(a,"AT1");a=Blockly.Arduino.getAdjusted(a,"AT2");var f=Blockly.Arduino.text.getIndex_,
g={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};b=Blockly.Arduino.provideFunction_("subsequence"+g[c]+g[d],["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==c||"FROM_START"==c?", at1":"")+("FROM_END"==d||"FROM_START"==d?", at2":"")+") {","  var start = "+f("sequence",c,"at1")+";","  var end = "+f("sequence",d,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+b+("FROM_END"==c||"FROM_START"==c?", "+e:"")+("FROM_END"==d||"FROM_START"==
d?", "+a:"")+")"}return[b,Blockly.Arduino.ORDER_FUNCTION_CALL]};
Blockly.Arduino.text_changeCase=function(a){var b={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[a.getFieldValue("CASE")];a=Blockly.Arduino.valueToCode(a,"TEXT",b?Blockly.Arduino.ORDER_MEMBER:Blockly.Arduino.ORDER_NONE)||"''";return[b?a+b:Blockly.Arduino.provideFunction_("textToTitleCase",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+
"("+a+")",Blockly.Arduino.ORDER_FUNCTION_CALL]};Blockly.Arduino.text_trim=function(a){var b={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[a.getFieldValue("MODE")];return[(Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_MEMBER)||"''")+b,Blockly.Arduino.ORDER_FUNCTION_CALL]};Blockly.Arduino.text_print=function(a){return"window.alert("+(Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_NONE)||"''")+");\n"};
Blockly.Arduino.text_prompt_ext=function(a){var b="window.prompt("+(a.getField("TEXT")?Blockly.Arduino.quote_(a.getFieldValue("TEXT")):Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_NONE)||"''")+")";"NUMBER"==a.getFieldValue("TYPE")&&(b="Number("+b+")");return[b,Blockly.Arduino.ORDER_FUNCTION_CALL]};Blockly.Arduino.text_prompt=Blockly.Arduino.text_prompt_ext;
Blockly.Arduino.text_count=function(a){var b=Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_MEMBER)||"''";a=Blockly.Arduino.valueToCode(a,"SUB",Blockly.Arduino.ORDER_NONE)||"''";return[Blockly.Arduino.provideFunction_("textCount",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+b+", "+a+")",Blockly.Arduino.ORDER_SUBTRACTION]};
Blockly.Arduino.text_replace=function(a){var b=Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_MEMBER)||"''",c=Blockly.Arduino.valueToCode(a,"FROM",Blockly.Arduino.ORDER_NONE)||"''";a=Blockly.Arduino.valueToCode(a,"TO",Blockly.Arduino.ORDER_NONE)||"''";return[Blockly.Arduino.provideFunction_("textReplace",["function "+Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',
"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+b+", "+c+", "+a+")",Blockly.Arduino.ORDER_MEMBER]};Blockly.Arduino.text_reverse=function(a){return[(Blockly.Arduino.valueToCode(a,"TEXT",Blockly.Arduino.ORDER_MEMBER)||"''")+".split('').reverse().join('')",Blockly.Arduino.ORDER_MEMBER]};Blockly.Arduino.variables={};Blockly.Arduino.variables_get=function(a){return[Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME),Blockly.Arduino.ORDER_ATOMIC]};Blockly.Arduino.variables_set=function(a){var b=Blockly.Arduino.valueToCode(a,"VALUE",Blockly.Arduino.ORDER_ASSIGNMENT)||"0";return Blockly.Arduino.variableDB_.getName(a.getFieldValue("VAR"),Blockly.VARIABLE_CATEGORY_NAME)+" = "+b+";\n"};
Blockly.Arduino.variablesDynamic={};Blockly.Arduino.variables_get_dynamic=Blockly.Arduino.variables_get;Blockly.Arduino.variables_set_dynamic=Blockly.Arduino.variables_set;